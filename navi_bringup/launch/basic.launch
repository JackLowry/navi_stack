<launch>
	<!-- Vision -->
	<group ns="vision">
		<node pkg="nodelet" type="nodelet" name="vision_manager" args="manager"/>

		<!-- Whiteness Colorspace Transformation -->
		<node pkg="nodelet" type="nodelet" name="white_filter_center" args="load white_filter/white_nodelet vision_manager">
			<rosparam command="load" file="$(find navi_cfg)/params/line_white.yaml"/>
			<remap from="image" to="/vision/narrow/left/image"/>
			<remap from="white" to="/vision/narrow/left/white"/>
		</node>
		<node pkg="nodelet" type="nodelet" name="white_filter_left" args="load white_filter/white_nodelet vision_manager">
			<rosparam command="load" file="$(find navi_cfg)/params/line_white.yaml"/>
			<remap from="image" to="/vision/wheel/left/image"/>
			<remap from="white" to="/vision/wheel/left/white"/>
		</node>
		<node pkg="nodelet" type="nodelet" name="white_filter_right" args="load white_filter/white_nodelet vision_manager">
			<rosparam command="load" file="$(find navi_cfg)/params/line_white.yaml"/>
			<remap from="image" to="/vision/wheel/right/image"/>
			<remap from="white" to="/vision/wheel/right/white"/>
		</node>

		<!-- Matched Pulse Width Filter -->
		<node pkg="nodelet" type="nodelet" name="line_detection_center" args="load line_detection/line_nodelet vision_manager">
			<rosparam command="load" file="$(find navi_cfg)/params/line_detection.yaml"/>
			<remap from="image"       to="/vision/narrow/left/white"/>
			<remap from="camera_info" to="/vision/narrow/left/camera_info"/>
			<remap from="line_points" to="/vision/narrow/left/line_points"/>
		</node>
		<node pkg="nodelet" type="nodelet" name="line_detection_left" args="load line_detection/line_nodelet vision_manager">
			<rosparam command="load" file="$(find navi_cfg)/params/line_detection.yaml"/>
			<remap from="image"       to="/vision/wheel/left/white"/>
			<remap from="camera_info" to="/vision/wheel/left/camera_info"/>
			<remap from="line_points" to="/vision/wheel/left/line_points"/>
		</node>
		<node pkg="nodelet" type="nodelet" name="line_detection_right" args="load line_detection/line_nodelet vision_manager">
			<rosparam command="load" file="$(find navi_cfg)/params/line_detection.yaml"/>
			<remap from="image"       to="/vision/wheel/right/white"/>
			<remap from="camera_info" to="/vision/wheel/right/camera_info"/>
			<remap from="line_points" to="/vision/wheel/right/line_points"/>
		</node>

		<!-- Model Fitting and Tracking -->
		<!--
		<node pkg="nodelet" type="nodelet" name="line_tracker" args="load line_tracking/tracker_node vision_manager">
			<rosparam command="load" file="$(find navi_cfg)/params/line_tracking.yaml"/>
			<remap from="points" to="left_line"/>
		</node>
		-->

		<!-- Stereo Vision -->
		<node pkg="nodelet" type="nodelet" name="stereo_ground" args="load stereo_plane/ground_nodelet vision_manager">
			<rosparam command="load" file="$(find navi_cfg)/params/stereo_ground.yaml"/>
			<remap from="points" to="narrow/points2"/>
		</node>
		<node pkg="stereo_od" type="od_node" name="stereo_od">
			<rosparam command="load" file="$(find navi_cfg)/params/stereo_od.yaml"/>
			<remap from="points"      to="narrow/points2"/>
			<remap from="camera_info" to="narrow/left/camera_info"/>
		</node>
		<group ns="narrow">
			<node pkg="stereo_image_proc" type="stereo_image_proc" name="narrow_proc">
				<remap from="stereo"          to="narrow"/>
				<remap from="left/image_raw"  to="left/image"/>
				<remap from="right/image_raw" to="right/image"/>
			</node>
		</group>
		<group ns="wide">
			<node pkg="stereo_image_proc" type="stereo_image_proc" name="wide_proc">
				<remap from="stereo"          to="wide"/>
				<remap from="left/image_raw"  to="left/image"/>
				<remap from="right/image_raw" to="right/image"/>
			</node>
		</group>
	</group>
</launch>
